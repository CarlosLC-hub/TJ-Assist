<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Territorios</title>

  <!-- CSS propio de la página -->
  <link rel="stylesheet" href="style-territorios.css">
</head>

<body>

<header>
  <button class="back" onclick="volver()">←</button>
  <h2>Territorios</h2>
</header>

<main>

  <p class="subtitulo">Congregación Esperanza Tenabo</p>

  <div class="territorios-grid">
    <button onclick="mostrarTerritorio(1)">Territorio 1</button>
    <button onclick="mostrarTerritorio(2)">Territorio 2</button>
    <button onclick="mostrarTerritorio(3)">Territorio 3</button>
    <button onclick="mostrarTerritorio(4)">Territorio 4</button>
    <button onclick="mostrarTerritorio(5)">Territorio 5</button>
    <button onclick="mostrarTerritorio(6)">Territorio 6</button>
    <button onclick="mostrarTerritorio(7)">Territorio 7</button>
    <button onclick="mostrarTerritorio(8)">Territorio 8</button>
    <button onclick="mostrarTerritorio(9)">Territorio 9</button>
    <button onclick="mostrarTerritorio(10)">Territorio 10<br>(Las Flores)</button>
  </div>

    <div id="mensaje-zoom" style="display:none;">
    <p>Doble toque para zoom</p>
    </div>

  <div class="imagen-container">
    <img id="imagen-territorio" src="" alt="Territorio">
  </div>



</main>

<script>
  function volver() {
    window.history.back();
  }
</script>


<!-- TU SCRIPT ORIGINAL, SIN CAMBIOS -->
<script>
  const imagen = document.getElementById('imagen-territorio');

  let scale = 1;
  const minScale = 1;
  const maxScale = 4; // Zoom máximo configurable

  let moverX = 0;
  let moverY = 0;

  let inicioX = 0;
  let inicioY = 0;

  let ultimoToque = 0;
  let arrastrando = false;

  let pinchInicial = 0;
  let scaleInicial = 1;

  function mostrarTerritorio(numero) {
    document.querySelectorAll('.territorios-grid button')
      .forEach(btn => btn.classList.remove('activo'));

    document.querySelectorAll('.territorios-grid button')[numero - 1]
      .classList.add('activo');

    imagen.src = `territorios/Territorio ${numero}.png`;
    imagen.style.display = 'block';

      // Mostrar mensaje solo si hay imagen
      document.getElementById('mensaje-zoom').style.display = 'block';

    resetTransform();
  }

  function resetTransform() {
    scale = 1;
    moverX = 0;
    moverY = 0;
    aplicarTransform();
  }

  function aplicarTransform() {
    limitarMovimiento();
    imagen.style.transform =
      `translate(${moverX}px, ${moverY}px) scale(${scale})`;
  }

  function limitarMovimiento() {
    const contenedor = imagen.parentElement;
    const maxX = (imagen.width * scale - contenedor.offsetWidth) / 2;
    const maxY = (imagen.height * scale - contenedor.offsetHeight) / 2;

    if (maxX > 0) {
      moverX = Math.max(-maxX, Math.min(maxX, moverX));
    } else {
      moverX = 0;
    }

    if (maxY > 0) {
      moverY = Math.max(-maxY, Math.min(maxY, moverY));
    } else {
      moverY = 0;
    }
  }

  /* -------- DOBLE TOQUE / DOBLE CLIC CENTRADO -------- */
  imagen.addEventListener('touchend', e => {
    const ahora = Date.now();
    if (ahora - ultimoToque < 300) {
      hacerZoom(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
    }
    ultimoToque = ahora;
  });

  imagen.addEventListener('dblclick', e => {
    hacerZoom(e.clientX, e.clientY);
  });

  function hacerZoom(clickX, clickY) {
    const contenedor = imagen.parentElement;
    const rect = contenedor.getBoundingClientRect();

    if (scale === minScale) {
      scale = maxScale;

      // Centrar zoom en el punto tocado
      moverX = (rect.width / 2 - (clickX - rect.left)) * (scale - 1);
      moverY = (rect.height / 2 - (clickY - rect.top)) * (scale - 1);
    } else {
      scale = minScale;
      moverX = 0;
      moverY = 0;
    }

    aplicarTransform();
  }

  /* -------- ARRASTRE MÓVIL -------- */
  imagen.addEventListener('touchstart', e => {
    if (e.touches.length === 1 && scale > 1) {
      arrastrando = true;
      inicioX = e.touches[0].clientX - moverX;
      inicioY = e.touches[0].clientY - moverY;
    }

    if (e.touches.length === 2) {
      pinchInicial = distancia(e.touches);
      scaleInicial = scale;
    }
  });

  imagen.addEventListener('touchmove', e => {
    e.preventDefault();

    // Arrastre
    if (arrastrando && e.touches.length === 1 && scale > 1) {
      moverX = e.touches[0].clientX - inicioX;
      moverY = e.touches[0].clientY - inicioY;
      aplicarTransform();
    }

    // Pinch zoom
    if (e.touches.length === 2) {
      const pinchActual = distancia(e.touches);
      scale = scaleInicial * (pinchActual / pinchInicial);
      scale = Math.max(minScale, Math.min(maxScale, scale));
      aplicarTransform();
    }
  });

  imagen.addEventListener('touchend', () => arrastrando = false);

  /* -------- ARRASTRE PC -------- */
  imagen.addEventListener('mousedown', e => {
    if (scale <= 1) return;
    arrastrando = true;
    inicioX = e.clientX - moverX;
    inicioY = e.clientY - moverY;
  });

  document.addEventListener('mousemove', e => {
    if (!arrastrando) return;
    moverX = e.clientX - inicioX;
    moverY = e.clientY - inicioY;
    aplicarTransform();
  });

  document.addEventListener('mouseup', () => arrastrando = false);

  function distancia(touches) {
    const dx = touches[0].clientX - touches[1].clientX;
    const dy = touches[0].clientY - touches[1].clientY;
    return Math.sqrt(dx * dx + dy * dy);
  }
</script>


</body>
</html>
